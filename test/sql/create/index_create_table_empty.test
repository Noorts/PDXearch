# name: test/sql/create/index_create_table_empty.test
# description: Index creation behavior on empty and on non-empty tables.
# group: [create]

require parquet

require pdxearch

# ============================================
# Empty table
# ============================================
statement ok
CREATE OR REPLACE TABLE t1 (id INTEGER, emb FLOAT[128]);

statement error
CREATE INDEX t1_idx ON t1 USING PDXEARCH (emb);
----
Binder Error: PDXearch index cannot be created on an empty table.

# ============================================
# Non-empty table
# ============================================
statement ok
CREATE OR REPLACE TABLE t1 (id INTEGER, emb FLOAT[128]);

statement ok
INSERT INTO t1 FROM read_parquet('test/assets/sift-128-euclidean-245760.parquet') LIMIT 10000;

statement ok
CREATE INDEX t1_idx ON t1 USING PDXEARCH (emb);
